EXPLAIN SELECT count(*)
FROM E0 AS E1
JOIN E0 AS E7
  ON E1.Id2 = E7.Id1
JOIN E0 AS E13
  ON E7.Id2 = E13.Id1
JOIN E0 AS E15
  ON E13.Id2 = E15.Id1
  AND E15.Id2 = E1.Id1
LEFT JOIN E0 AS E2
  ON E2.Id1 = E1.Id1
  AND E2.Id2 = E13.Id1
  WHERE E2.Id1 IS NULL
  AND E1.Id1 != E7.Id2
  AND E1.Id2 != E13.Id2;
