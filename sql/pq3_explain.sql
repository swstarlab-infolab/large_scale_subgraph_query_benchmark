EXPLAIN SELECT count(*)
FROM Person_knows_Person AS PKP1
JOIN Person_knows_Person AS PKP2
  ON PKP1.Person1Id = PKP2.Person2Id
JOIN Person_knows_Person AS PKP3
  ON PKP2.Person1Id = PKP3.Person2Id
  AND PKP3.Person1Id = PKP1.Person2Id
JOIN Person_isLocatedIn_City AS PIC1
  ON PIC1.PersonId = PKP1.Person1Id
JOIN Person_isLocatedIn_City AS PIC2
  ON PIC2.PersonId = PKP2.Person1Id
JOIN Person_isLocatedIn_City AS PIC3
  ON PIC3.PersonId = PKP3.Person1Id
JOIN City_isPartOf_Country AS CiC1
  ON CiC1.CityId = PIC1.CityId
JOIN City_isPartOf_Country AS CiC2
  ON CiC2.CityId = PIC2.CityId
JOIN City_isPartOf_Country AS CiC3
  ON CiC3.CityId = PIC3.CityId
  AND CiC1.CountryId = CiC2.CountryId
  AND CiC2.CountryId = CiC3.CountryId
